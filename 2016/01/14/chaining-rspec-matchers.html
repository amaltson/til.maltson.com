<!DOCTYPE html>
<html class=" " lang="en" >
<head>
<meta charset="utf-8">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="http://til.maltson.com/2016/01/14/chaining-rspec-matchers.html" rel="canonical">
<meta name='generator' content='Octopress v Jekyll v2.5.3, Octopress v3.0.11 Octopress Ink v1.2.1'>
<title>Chaining RSpec Matchers</title>

<link href='/stylesheets/all-98cfbc21f93ed51c0a0cc2c2a8531d86.css' media='all' rel='stylesheet' type='text/css'>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-70516502-1', 'auto');
  ga('send', 'pageview');
</script>


</head>
<body>
  <style>use { height: 0; }</style>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/" style="display: none">
  <g id="site-search-svg"><path d="M125.7,120l-5.7,5.7c-1.5,1.5-3.5,2.3-5.7,2.3c-2.1,0-4.2-0.8-5.7-2.3L72.4,89.3C65.2,93.6,56.9,96,48,96 C21.5,96,0,74.5,0,48S21.5,0,48,0s48,21.5,48,48c0,8.9-2.4,17.2-6.7,24.4l36.3,36.3C128.8,111.8,128.8,116.9,125.7,120z M48,80 c17.7,0,32-14.3,32-32S65.7,16,48,16c-17.7,0-32,14.3-32,32S30.3,80,48,80z"/></g>
</svg>
  <div class="site"><div class='nav-panel'>
<nav class='mobile-nav' role="navigation">
  <div class='mobile-nav-item mobile-nav-search'><form class='site-search' action="https://google.com/search" method="get">
  <input type="hidden" name="sitesearch" value="til.maltson.com">
  <input id='site-search-mobile' class="site-search-input" type="text" name="q" results="0" placeholder="Search" accesskey="/">
  <label class='site-search-label' for='site-search-mobile'><svg class='site-search-icon' viewBox="0 0 128 128">
    <use xlink:href="#site-search-svg"></use>
  </svg></label>
</form></div>
  <a class="mobile-nav-item " href="/"/>Posts</a>

  
  
  
  
  <a class="mobile-nav-item " href="/archive/">Archive</a>

  
  
  
  
  <a class="mobile-nav-item " href="/feed/">Subscribe</a>
  
</nav>
</div>
<div class="site-content">
<div class="site-top"><div class="site-top-content">
<header role="banner" class="site-header">
  <h1 class="site-title"><a class="site-title-link" href="/"/>Today I Learned</a></h1>
</header>
<nav class='main-nav' role="navigation">
  <a class="main-nav-item " href="/"/>Posts</a>
  <a class="main-nav-item " href="/archive/">Archive</a>
  <a class="main-nav-item " href="/feed/">Subscribe</a>
  <div class='main-nav-item main-nav-search'><form class='site-search' action="https://google.com/search" method="get">
  <input type="hidden" name="sitesearch" value="til.maltson.com">
  <input id='site-search-main' class="site-search-input" type="text" name="q" results="0" placeholder="Search" accesskey="/">
  <label class='site-search-label' for='site-search-main'><svg class='site-search-icon' viewBox="0 0 128 128">
    <use xlink:href="#site-search-svg"></use>
  </svg></label>
</form></div>
  <button class="mobile-nav-toggle" href="#" onclick="(function(){ document.querySelector('html').classList.toggle('mobile-nav-active') })()"><span class="mobile-nav-icon"></span><span class="hidden-label">Navigate<span></span></span></button>
</nav>
</div></div>
<div class="site-main">
<div class="main ">
  <div class="main-content">
<article class="entry post   " role="article">
  <header class="entry-header">
    
    <div class='entry-header-content'>
      <h1 class="entry-title">Chaining RSpec&nbsp;Matchers</h1>
      
      
    </div>
  </header>

  <div class="entry-meta"><a class='entry-date' href="/2016/01/14/chaining-rspec-matchers.html"><time class='entry-date' datetime='2016-01-14T22:05:19-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span></time></a></div>

  <div class="entry-content">
<p>I‚Äôm on a bit of an RSpec TIL bonanza, primary because I‚Äôm taking the time to dig
into the RSpec documentation and see what it has to offer.</p>

<p>One of my favourite assertion libraries from the Java world, that a coworker
turned me onto a couple of years ago, is <a href="http://joel-costigliola.github.io/assertj/">AssertJ</a>. One of the nicest features in
AssertJ was the ability to easily chain assertions off one expectation.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">assertThat</span><span class="o">(</span><span class="n">fellowshipOfTheRing</span><span class="o">).</span><span class="na">hasSize</span><span class="o">(</span><span class="mi">9</span><span class="o">)</span>
                               <span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">frodo</span><span class="o">,</span> <span class="n">sam</span><span class="o">)</span>
                               <span class="o">.</span><span class="na">doesNotContain</span><span class="o">(</span><span class="n">sauron</span><span class="o">);</span></code></pre></div>

<p>While writing the aforementioned CLI tool, I wanted to test that it output to
both <code>stdout</code> and <code>stderr</code>. I started to wonder if there‚Äôs a way to do this Java
‚Äúbuilder‚Äù chaining in RSpec. I shouldn‚Äôt be surprised anymore, but <em>of course</em>
the RSpec developers have already thought of this. In the RSpec world they‚Äôre
called <a href="https://relishapp.com/rspec/rspec-expectations/docs/compound-expectations">Compound Matchers</a> and they look something like this:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">&#39;rspec&#39;</span>

<span class="n">describe</span> <span class="no">Cli</span><span class="o">::</span><span class="no">App</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">&#39;should output to stdout and stderr&#39;</span> <span class="k">do</span>
    <span class="n">expect</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s1">&#39;Hello, world!&#39;</span><span class="p">;</span> <span class="nb">warn</span> <span class="s1">&#39;Goodbye, world!&#39;</span> <span class="p">}</span>
      <span class="o">.</span><span class="n">to</span> <span class="n">output</span><span class="p">(</span><span class="s2">&quot;Hello, world!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_stdout</span>
      <span class="o">.</span><span class="n">and</span> <span class="n">output</span><span class="p">(</span><span class="s2">&quot;Goodbye, world!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_stderr</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>Now I can have the fluid chained assertions in RSpec that I‚Äôve come to expect
from AssertJ üéä‚ú®</p>



<div class="entry-social-sharing social-links"><a class="twitter-share-link" href="https://twitter.com/intent/tweet?&text=Chaining%20RSpec%20Matchers%20%20%20-%20http%3A%2F%2Ftil.maltson.com%2F2016%2F01%2F14%2Fchaining-rspec-matchers.html" title="Share on Twitter">Twitter</a><a class="facebook-share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://til.maltson.com/2016/01/14/chaining-rspec-matchers.html" title="Share on Facebook">Facebook</a><a class="g-plus-share-link" href="https://plus.google.com/share?url=http://til.maltson.com/2016/01/14/chaining-rspec-matchers.html" title="Share on Google+">Google+</a><a class="email-share-link" href="mailto:?subject=Chaining%20RSpec%20Matchers&body=Chaining%20RSpec%20Matchers%20%20-%20http%3A%2F%2Ftil.maltson.com%2F2016%2F01%2F14%2Fchaining-rspec-matchers.html" title="Share via email">Email</a></div>

<nav role="pagination" class="post-nav">

<a class="previous-post" href="/2016/01/13/capture-stdout-stderr-with-rspec.html" title="Previous Article: Capture Standard Output/Standard Error With RSpec">
  <div class='previous-post-marker'><span class='previous-post-arrow'>&larr;</span> Previous Article</div>
  <h6 class='previous-post-title'>Capture Standard Output/Standard Error With RSpec</h6>
</a>


</nav>


</div>

  <footer class='entry-footer' role='contentinfo'>
    
  </footer>

</article>
</div>
  
</div>
</div>
<div class="site-bottom"><div class="site-bottom-content">
<footer class='site-footer' role="contentinfo">
  <p class='footer-copyright'>Copyright ¬© 2016
  - Powered by <a href='http://octopress.org'>Octopress</a></p>
  
</footer>
</div></div></div>
</div>
  <script async src='/javascripts/all-24ab3e64bcfb066922f6e5ab6b66404e.js'></script>
  
  
</body>
</html>
